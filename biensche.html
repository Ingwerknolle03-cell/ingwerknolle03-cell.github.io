
<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Pflege deine Blume</title>
<style>
  body { margin: 0; overflow: hidden; background: #a0dca0; display: flex; justify-content: center; align-items: center; height: 100vh; }
  canvas { display: block; }
  #status { position: absolute; top: 10px; left: 10px; color: #fff; font-family: sans-serif; }
</style>
</head>
<body>
<canvas id="flowerCanvas" width="600" height="400"></canvas>
<div id="status"></div>

<script>
const canvas = document.getElementById('flowerCanvas');
const ctx = canvas.getContext('2d');
const statusDiv = document.getElementById('status');

// --- Spielzustand ---
let flower = {
  stage: 0, // 0-3
  water: 50,
  light: 50,
  clean: 50,
  x: canvas.width/2,
  y: canvas.height/2 + 50
};

let rain = false;
let sun = false;
let particles = [];

// --- Helferfunktionen ---
function drawBackground() {
  // Himmel
  ctx.fillStyle = '#87CEEB';
  ctx.fillRect(0, 0, canvas.width, canvas.height/2);
  // Wiese
  ctx.fillStyle = '#88cc88';
  ctx.fillRect(0, canvas.height/2, canvas.width, canvas.height/2);
}

function drawFlower() {
  const size = 5 + flower.stage * 15;
  
  // Stiel
  ctx.fillStyle = '#228B22';
  ctx.fillRect(flower.x-5, flower.y, 10, 40);
  
  // Blätter
  ctx.fillStyle = '#2e8b57';
  ctx.beginPath();
  ctx.ellipse(flower.x-10, flower.y+20, 5, 10, -Math.PI/6, 0, 2*Math.PI);
  ctx.fill();
  ctx.beginPath();
  ctx.ellipse(flower.x+10, flower.y+25, 5, 10, Math.PI/6, 0, 2*Math.PI);
  ctx.fill();
  
  // Blüte mit mehreren Blütenblättern
  ctx.fillStyle = 'pink';
  for(let i=0; i<6; i++){
    let angle = (i/6) * 2 * Math.PI;
    let bx = flower.x + Math.cos(angle)*size;
    let by = flower.y - Math.sin(angle)*size;
    ctx.beginPath();
    ctx.ellipse(bx, by, size/2, size, angle, 0, 2*Math.PI);
    ctx.fill();
  }
  // Blütenmitte
  ctx.fillStyle = 'yellow';
  ctx.beginPath();
  ctx.arc(flower.x, flower.y, size/2, 0, Math.PI*2);
  ctx.fill();
}

function drawParticles() {
  particles.forEach(p => {
    ctx.fillStyle = p.color;
    ctx.fillRect(p.x, p.y, 2, 2);
  });
}

function spawnParticles() {
  if(rain){
    for(let i=0;i<3;i++){
      particles.push({x: Math.random()*canvas.width, y:0, color:'#00f', vy:2+Math.random()*2});
    }
  }
}

function updateParticles() {
  particles.forEach((p,i)=>{
    p.y += p.vy;
    if(p.y>canvas.height) particles.splice(i,1);
  });
}

// --- Spielmechanik ---
function update() {
  // Werte sinken langsam
  flower.water -= 0.05;
  flower.light -= 0.02;
  flower.clean -= 0.01;

  // Regen & Sonne erhöhen Werte
  if(rain) flower.water += 0.3;
  if(sun) flower.light += 0.2;

  // Wachstum
  if(flower.water > 30 && flower.light > 30 && flower.clean > 30){
    flower.stage = Math.min(flower.stage + 0.001, 3);
  }

  // Überfluss kann Blume schädigen
  if(flower.water > 100) flower.water -= 0.1;
  if(flower.light > 100) flower.light -= 0.1;

  // Partikel generieren
  spawnParticles();
  updateParticles();
}

// --- UI / Status ---
function drawStatus() {
  statusDiv.innerHTML = `
    Wasser: ${flower.water.toFixed(0)}<br>
    Licht: ${flower.light.toFixed(0)}<br>
    Sauberkeit: ${flower.clean.toFixed(0)}<br>
    Blütenstufe: ${Math.floor(flower.stage)+1}<br>
    Steuerung: R=Regen, L=Sonne, G=Gras schneiden
  `;
}

// --- Haupt-Loop ---
function draw() {
  drawBackground();
  drawFlower();
  drawParticles();
  drawStatus();
  update();
  requestAnimationFrame(draw);
}

// --- Steuerung ---
window.addEventListener('keydown', (e) => {
  if(e.key === 'r') rain = !rain;       // Regen an/aus
  if(e.key === 'g') flower.clean += 10; // Gras schneiden
  if(e.key === 'l') sun = !sun;         // Sonne an/aus
});

// Start
draw();
</script>
</body>
</html>
