<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>2D Pixel Garten</title>
<style>
body { margin: 0; overflow: hidden; background: #87CEEB; font-family: monospace; }
canvas { display: block; }
#ui { position: absolute; top: 10px; left: 10px; z-index: 10; }
button { font-size: 14px; margin: 2px; padding: 5px; cursor: pointer; }
#log { position: absolute; bottom: 10px; left: 10px; width: 300px; max-height: 200px; overflow-y: auto; background: rgba(255,255,255,0.7); border: 1px solid #0a0; padding: 5px; font-size: 12px; }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<div id="ui">
  <button id="sunBtn">‚òÄÔ∏è Sonne</button>
  <button id="rainBtn">üåß Regen</button>
  <button id="beeGameBtn">üêù Bienenfangen</button>
  <button id="saveBtn">üíæ Speichern</button>
  <button id="loadBtn">üìÇ Laden</button>
  <input type="file" id="fileInput" style="display:none;" accept=".json" />
</div>
<div id="log"></div>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const logDiv = document.getElementById('log');
function log(text){ const p=document.createElement('div'); p.textContent=text; logDiv.appendChild(p); logDiv.scrollTop=logDiv.scrollHeight; }

let game = {
  flowers: [],
  seedPlanted: false,
  flowerHealth:0,
  bees:[],
  rain:false,
  sun:1,
  nectar:0,
  bird:{x:50,y:canvas.height-150, targetX:300, targetY:canvas.height-200, feeding:false, satiety:0}
};

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Himmel
  ctx.fillStyle='#87CEEB';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Sonne
  ctx.fillStyle='#FFD700'; ctx.beginPath(); ctx.arc(100,100,40,0,Math.PI*2); ctx.fill();

  // Regen
  if(game.rain){
    ctx.strokeStyle='rgba(0,0,255,0.5)';
    for(let i=0;i<200;i++){
      let x=Math.random()*canvas.width; let y=Math.random()*canvas.height; ctx.beginPath(); ctx.moveTo(x,y); ctx.lineTo(x,y+10); ctx.stroke();
    }
  }

  // Wiese mit H√ºgeln
  ctx.fillStyle='#228B22';
  ctx.beginPath();
  ctx.moveTo(0,canvas.height-100);
  for(let i=0;i<canvas.width;i+=50){
    let h=canvas.height-100-20*Math.sin(i/50);
    ctx.lineTo(i,h);
  }
  ctx.lineTo(canvas.width,canvas.height);
  ctx.lineTo(0,canvas.height);
  ctx.closePath();
  ctx.fill();

  // Vogel
  let b = game.bird;
  ctx.fillStyle='brown'; ctx.fillRect(b.x-10,b.y-10,20,20); // K√∂rper
  ctx.fillStyle='yellow'; ctx.beginPath(); ctx.moveTo(b.x+10,b.y); ctx.lineTo(b.x+20,b.y-5); ctx.lineTo(b.x+20,b.y+5); ctx.fill(); // Schnabel
  if(!b.feeding){
    if(b.x<b.targetX) b.x+=2;
    if(b.y>b.targetY) b.y-=1;
  }
  if(b.x>=b.targetX && b.y<=b.targetY && !b.feeding){ b.feeding=true; log('üê¶ Vogel sitzt auf dem Baum.'); }

  // Blumen
  game.flowers.forEach(f=>{
    if(f.health>0){
      if(f.health>5) f.bloom=true;
      f.health += 0.01*game.sun + 0.02*(game.rain?1:0) + 0.01*game.nectar;
      ctx.fillStyle=f.bloom?'#FFD700':'#FFA500';
      ctx.fillRect(f.x,f.y-50,f.size,f.size*2);
      ctx.fillStyle='#006400';
      ctx.fillRect(f.x+f.size/2,f.y,f.size/2,50*f.size);
    }
  });

  requestAnimationFrame(draw);
}
draw();

// UI
document.getElementById('sunBtn').onclick=()=>{game.sun+=0.1; log('Sonne hoch ‚òÄÔ∏è');}
document.getElementById('rainBtn').onclick=()=>{game.rain=!game.rain; log(game.rain?'Regen üåß':'Regen aufgeh√∂rt');}
document.getElementById('beeGameBtn').onclick=()=>{
  for(let i=0;i<5;i++) game.bees.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height/2,vx:1+Math.random()*2,vy:(Math.random()-0.5)*1});
  log('üêù Bienen fliegen! Fange sie!');
}

// Save/Load
const saveBtn=document.getElementById('saveBtn'); const loadBtn=document.getElementById('loadBtn'); const fileInput=document.getElementById('fileInput');
saveBtn.onclick=()=>{
  const blob=new Blob([JSON.stringify(game)],{type:'application/json'});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='pixel_garten.json'; a.click(); URL.revokeObjectURL(a.href);
  log('üíæ Spiel gespeichert');
};
loadBtn.onclick=()=>{fileInput.click();}
fileInput.onchange=()=>{
  const file=fileInput.files[0];
  const reader=new FileReader();
  reader.onload=e=>{try{game=JSON.parse(e.target.result); log('üìÇ Spiel geladen');}catch(err){log('Fehler beim Laden');}}
  reader.readAsText(file);
};

// Click auf Wiese f√ºr Samen
canvas.addEventListener('click',e=>{
  if(e.clientY>canvas.height-150){
    game.flowers.push({x:e.clientX,y:e.clientY,size:10,health:1,bloom:false});
    log('üå± Samen gepflanzt');
  }
});
</script>
</body>
</html>


