<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Chronos â€“ Ã–kosystem 2.0</title>
<style>
body{margin:0;font-family:monospace;background:#0b0f0b;color:#9f9;display:flex;height:100vh}
#left{flex:3;padding:15px;border-right:2px solid #3f3}
#right{flex:1;padding:15px;background:#050}
h1,h2{margin:0 0 10px}
#log{height:40%;overflow:auto;border:1px solid #3f3;padding:8px;background:#000}
#table{height:40%;overflow:auto;border:1px solid #3f3;margin-top:10px}
button{background:#060;color:#cfc;border:1px solid #3f3;padding:5px;margin:3px;cursor:pointer}
button:hover{background:#090}
</style>
</head>

<body>
<div id="left">
<h1>Chronos â€“ Ã–kosystem</h1>
<div id="log"></div>
<div id="table"></div>
<button onclick="toggle()">Start / Stop</button>
</div>

<div id="right">
<h2>Pflanzen</h2>
<div id="plants"></div>
<h2>Tiere</h2>
<div id="animals"></div>
</div>

<script>
const log = msg => {
  document.getElementById("log").innerText += msg + "\n";
};

let running = true;
let year = 0;

const species = {
  // ðŸŒ± Pflanzen
  Gras:{typ:"pflanze",wachstum:0.4,max:1000},
  Weizen:{typ:"pflanze",wachstum:0.3,max:800},
  Eiche:{typ:"pflanze",wachstum:0.05,max:300},
  Algen:{typ:"pflanze",wachstum:0.6,max:1500},

  // ðŸ› Pflanzenfresser
  Raupe:{typ:"tier",frisst:["Gras","Weizen"],wachstum:0.3,max:400},
  Hase:{typ:"tier",frisst:["Gras","Weizen"],wachstum:0.2,max:200},
  Reh:{typ:"tier",frisst:["Gras"],wachstum:0.15,max:150},
  Fisch:{typ:"tier",frisst:["Algen"],wachstum:0.25,max:300},

  // ðŸº RÃ¤uber
  Fuchs:{typ:"tier",frisst:["Hase","Raupe"],wachstum:0.12,max:80},
  Wolf:{typ:"tier",frisst:["Reh","Hase"],wachstum:0.08,max:60},
  Vogel:{typ:"tier",frisst:["Raupe"],wachstum:0.2,max:120},
};

let world = {};

Object.keys(species).forEach(s => world[s] = 0);

function add(name,amount){
  world[name]+=amount;
  log(`${name} hinzugefÃ¼gt (+${amount})`);
  draw();
}

function draw(){
  const t = document.getElementById("table");
  t.innerHTML = "";
  Object.entries(world).forEach(([k,v])=>{
    if(v>0) t.innerHTML += `${k}: ${v}<br>`;
  });
}

function grow(){
  year++;
  log(`--- Jahr ${year} ---`);

  // Wachstum
  Object.entries(species).forEach(([name,sp])=>{
    if(world[name]>0){
      let foodFactor = 1;

      if(sp.frisst){
        const food = sp.frisst.reduce((s,f)=>s+(world[f]||0),0);
        foodFactor = food>0 ? 1 : 0.3;
      }

      const delta = Math.floor(world[name]*sp.wachstum*foodFactor*(1-world[name]/sp.max));
      if(delta>0){
        world[name]+=delta;
        log(`${name} wÃ¤chst (+${delta})`);
      }
    }
  });

  // Fressen
  Object.entries(species).forEach(([pred,sp])=>{
    if(!sp.frisst || world[pred]<=0) return;
    sp.frisst.forEach(prey=>{
      if(world[prey]>0){
        const eat = Math.min(world[prey], Math.floor(world[pred]*0.2));
        if(eat>0){
          world[prey]-=eat;
          log(`${pred} frisst ${prey} (-${eat})`);
        }
      }
    });
  });

  draw();
}

setInterval(()=>{ if(running) grow(); },1000);

function toggle(){ running=!running; }

// Buttons
const pDiv=document.getElementById("plants");
const aDiv=document.getElementById("animals");

Object.entries(species).forEach(([n,s])=>{
  const b=document.createElement("button");
  b.innerText=n;
  b.onclick=()=>add(n,s.typ==="pflanze"?50:10);
  (s.typ==="pflanze"?pDiv:aDiv).appendChild(b);
});

draw();
</script>
</body>
</html>
